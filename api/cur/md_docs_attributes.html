<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>icedb: Attributes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">icedb
   &#160;<span id="projectnumber">version 0.4.2</span>
   </div>
   <div id="projectbrief">Snow particle scattering database API</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Attributes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The scattering database uses attributes to hold metadata about data and files. The attributes in the API library are designed to match their HDF5/netCDF counterparts. Both files and datasets may be tagged with attributes.</p>
<h2>What is an attribute?</h2>
<p>From the NetCDF manual:</p>
<p>"Attributes are used to store data about the data (ancillary data or metadata), similar in many ways to the information stored in data dictionaries and schema in conventional database systems. Most attributes provide information about a specific variable. These are identified by the name (or ID) of that variable, together with the name of the attribute.</p>
<p>An attribute has an associated file / folder / group / table, a name, a data type, a length, and a value. The current version treats all attributes as matrices; scalar values are treated as single-element vectors. "</p>
<h2>Usage</h2>
<p>Each attribute is stored in an HDF5 object. When read or written, an attribute is encapsulated in an icedb::Attributes::Attribute&lt;T&gt; template class.</p>
<div class="fragment"><div class="line">namespace icedb {</div><div class="line">    namespace Attributes {</div><div class="line">        template &lt;class DataType&gt; class Attribute {</div><div class="line">        public:</div><div class="line">            typedef DataType type;</div><div class="line">            std::vector&lt;DataType&gt; data;</div><div class="line">            std::string name;</div><div class="line">            std::vector&lt;size_t&gt; dimensionality;</div><div class="line">            bool isArray() const;</div><div class="line"></div><div class="line">            Attribute(const std::string &amp;name);</div><div class="line">            Attribute(const std::string &amp;name, DataType val);</div><div class="line">            Attribute(const std::string &amp;name, std::initializer_list&lt;size_t&gt; dims, std::initializer_list&lt;DataType&gt; data);</div><div class="line">        };</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>Attributes have a name, dimensions, and a datatype. Here is how you can define an attribute: </p><div class="fragment"><div class="line">icedb::Attributes::Attribute&lt;double&gt; attrDouble1(</div><div class="line">    &quot;TestDouble1&quot;, { 1 }, { 2.0 });</div></div><!-- fragment --><p> This creates an attribute, called "TestDouble1", with a double type, expressed as a one-dimensional array with a single value (1) in this dimension, with a value of 2.0. We can write this attribute to a group using: </p><div class="fragment"><div class="line">grpTest1-&gt;writeAttribute(attrDouble1);</div></div><!-- fragment --><p>In HDF5, attributes can be multi-dimensional, but in netCDF, they may have only a single dimension. Here is how to define a single-dimensional vector of four floating-point values: </p><div class="fragment"><div class="line">icedb::Attributes::Attribute&lt;float&gt; attrFloat2(</div><div class="line">    &quot;TestFloat2&quot;,</div><div class="line">    { 4 },</div><div class="line">    { 1.0f, 2.0f, 2.5f, 3.0f });</div><div class="line">grpTest1-&gt;writeAttribute(attrFloat2);</div></div><!-- fragment --><p>HDF5 supports multi-dimensional attributes, but NetCDF does not. Since icedb files are supposed to be accessible to either NetCDF or HDF5, we likewise do not support multi-dimensional attributes. However, if you want to use these attributes in your own project, then a multi-dimensional attribute may be defined this way: </p><div class="fragment"><div class="line">icedb::Attributes::Attribute&lt;float&gt; attrFloat3(</div><div class="line">    &quot;TestFloat3&quot;,</div><div class="line">    { 2, 3 },</div><div class="line">    { 1.0f, 2.0f, 3.1f, 4.2f, 5.3f, 6.0f});</div></div><!-- fragment --><p>Also note, there is a difference between a vector (a one-dimensional array) and a two-dimensional array that has one of the dimension lengths set to one. For example, here is how to define a 1x3 matrix. It will not work with netCDF. </p><div class="fragment"><div class="line">icedb::Attributes::Attribute&lt;float&gt; attrFloat4(</div><div class="line">    &quot;TestFloat4&quot;,</div><div class="line">    { 1, 3 },</div><div class="line">    { 4.2f, 5.3f, 6.0f });</div></div><!-- fragment --><p>For ease of typing, we can write attributes more easily using lines like these: </p><div class="fragment"><div class="line">grpTest1-&gt;writeAttribute(icedb::Attributes::Attribute&lt;uint64_t&gt;(&quot;TestInt5&quot;, { 1 }, { 65536 }));</div></div><!-- fragment --><p> or </p><div class="fragment"><div class="line">grpTest1-&gt;writeAttribute&lt;uint64_t&gt;(&quot;TestInt5&quot;, {1}, {65536});</div></div><!-- fragment --><p>Attributes can be floats, doubles, signed and unsigned integers (int64_t, uint64_t, int32_t, uint32_t, int16_t, uint16_t, int8_t, uint8_t), and strings of characters (std::string). Any other types are invalid. I might extend the interface to support these later on, but there isn't much need to do so. </p><div class="fragment"><div class="line">grpTest1-&gt;writeAttribute(icedb::Attributes::Attribute&lt;std::string&gt;(&quot;TestString6&quot;, &quot;Test string 6&quot;));</div></div><!-- fragment --><p>Currently, there is one restriction for writing strings: only a single string can be written to an attribute. So, this statement will not work: </p><div class="fragment"><div class="line">grpTest1-&gt;writeAttribute(icedb::Attributes::Attribute&lt;std::string&gt;(&quot;TestStringSet7&quot;, { 2 }, { &quot;Test string 7&quot;, &quot;TS 8&quot; }));</div></div><!-- fragment --><p> This will eventually be fixed.</p>
<p>Of course, you will also want to be able to read attributes. The syntax is similar. </p><div class="fragment"><div class="line">icedb::Attributes::Attribute&lt;std::string&gt; readTS6 = grpTest1-&gt;readAttribute&lt;std::string&gt;(&quot;TestString6&quot;);</div><div class="line">std::cout &lt;&lt; &quot;We just read TestString6 = &quot; &lt;&lt; readTS6.data[0] &lt;&lt; std::endl;</div></div><!-- fragment --><h2>Functions</h2>
<p>The attributes have a uniform programming interface. This interface allows you to read attributes, add attributes, check for the existence of attributes, et cetera.</p>
<p>All objects that can contain attributes inherit from the CanHaveAttributes class. This class provides functions for listing attributes, getting their stored types, reading, writing and deleting attributes. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
